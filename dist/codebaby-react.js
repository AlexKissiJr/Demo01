"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("react"),h={tansformEventName(e){return this.types[e]?this.types[e]:e},types:{ask:"na-ask.vidbaby",initialized:"na-initialized.vidbaby",playResponseData:"na-playResponseData.vidbaby",response:"na-response.vidbaby",playResponse:"na-playResponse.vidbaby",microphoneStarted:"na-microphoneStarted.vidbaby",microphoneAudio:"na-microphoneAudio.vidbaby",microphoneData:"na-microphoneData.vidbaby",microphoneStop:"na-microphoneStop.vidbaby",microphoneStopped:"na-microphoneStopped.vidbaby",playerBuilt:"na-playerBuilt.vidbaby",unPark:"na-unPark.vidbaby",segmentEnded:"na-segmentEnded.vidbaby",clientData:"na-clientData.vidbaby",extractedEntity:"na-extractedEntity.vidbaby",play:"na-play.vidbaby",pause:"na-pause.vidbaby",mute:"na-mute.vidbaby",unmute:"na-unmute.vidbaby","player:state":"na-player:state.vidbaby",preRender:"na-preRender.vidbaby",interimPlayResponse:"na-interimPlayResponse.vidbaby",interimResponse:"na-interimResponse.vidbaby",interimSegmentEnded:"na-interimSegmentEnded.vidbaby",playerLoadingAssets:"na-playerLoadingAssets.vidbaby","record-start":"na-record-start.vidbaby","record-stop":"na-record-stop.vidbaby","video-progress":"na-video-progress.vidbaby","video-converted":"na-video-converted.vidbaby","video-ready":"na-video-ready.vidbaby","video-cancel":"na-video-cancel.vidbaby",camChange:"na-camChange.vidbaby",glbLoaded:"na-glbLoaded.vidbaby"}},l=h;function m(e){const a=e.replace(/([A-Z])/g,i=>`-${i[0].toLowerCase()}`);return Object.keys(l.types).includes(a)?a:e}const w=({src:e,type:a="module",async:i=!0})=>new Promise((b,d)=>{const o=document.createElement("script");o.src=e,o.type=a,o.async=i,o.onload=()=>b(o),o.onerror=()=>d(new Error("Failed to load script. Check your internet connection.")),document.head.appendChild(o)});async function C(){if(typeof window.jQuery>"u"||typeof window.$!="function"||window.jQuery.fn.jquery===void 0||window.jQuery.fn.jquery<"3.4.1"){let e=null,a=null;typeof window.jQuery<"u"&&(e=window.jQuery,a=window.$),await w({src:"https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js",type:"text/javascript",async:!1}),window.vidbaby$=window.$,e&&(window.$=a,window.jQuery=e)}else window.vidbaby$=window.$;typeof window.$>"u"&&(window.$=window.jQuery)}function j({id:e,env:a}){const[i,b]=t.useState();return t.useLayoutEffect(()=>{const d=async()=>{const o=a==="local"||a==="localhost"?`http://localhost:8080/loader.js?env=${a}&id=${e}`:`https://portal.codebaby.com/loader.js?env=${a||"prod"}&id=${e}`;await C(),await w({src:o}),b(()=>window.vidbaby$)};window?d():setTimeout(d,3e3)},[]),i}const E=t.createContext({on(e,a){},off(e,a){},trigger(e,a){}}),g=E,$=t.forwardRef(function({children:a,id:i,env:b,...d},o){const r=j({id:i,env:b}),v=t.useCallback((s,c)=>{r&&r(document).on(l.tansformEventName(s),c)},[r]),p=t.useCallback((s,c)=>{r&&r(document).off(l.tansformEventName(s),c)},[r]),f=t.useCallback((s,c)=>{r&&r(document).trigger(l.tansformEventName(s),c)},[r]),y=t.useMemo(()=>({on:v,off:p,trigger:f}),[v,p,f]);return t.useImperativeHandle(o,function(){return y},[y]),t.useEffect(()=>{if(!r||!d||Object.keys(d).length===0)return;const s=d,c=Object.keys(d).filter(n=>n.startsWith("on")).map(n=>n.replace("on","")).map(n=>n.charAt(0).toLowerCase()+n.slice(1));if(!(c.length<=0)){for(const n of c){const u=`on${n.charAt(0).toUpperCase()+n.slice(1)}`;y.on(m(n),s[u])}return()=>{for(const n of c){const u=`on${n.charAt(0).toUpperCase()+n.slice(1)}`;y.off(m(n),s[u])}}}},[d,r]),t.createElement(g.Provider,{value:y},t.createElement(t.Fragment,null,a,t.createElement("div",{id:"avatarContainer",className:"codebaby-react-avatar-container"})))});function k(){const{on:e,off:a,trigger:i}=t.useContext(g);return{on:e,off:a,trigger:i}}function R(){const[e,a]=t.useState(!1);return t.useEffect(()=>{let i=null;const b=()=>{if(window&&window.vidbaby$&&window.vidbaby&&window.vidbaby.initialized)return a(!0);i=setTimeout(b,1e3)};return b(),()=>{i&&clearTimeout(i)}},[]),e}exports.AvatarProvider=$;exports.useCodebabyEvents=k;exports.useIsInitialized=R;
//# sourceMappingURL=codebaby-react.js.map
